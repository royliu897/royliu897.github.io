<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Floor Generator</title>
    <style>
        body { background: #333; color: white; text-align: center; font-family: sans-serif; }
        canvas { border: 2px solid white; max-width: 90%; margin-top: 20px; }
        button { padding: 15px 30px; font-size: 1.2rem; cursor: pointer; background: #4CAF50; color: white; border: none; border-radius: 5px; margin-top: 20px;}
        button:hover { background: #45a049; }
    </style>
</head>
<body>
    <h1>Floor Generator</h1>
    <p>1. Wait for the image below to appear.</p>
    <p>2. Click "Download Floor" and save it as <b>complete_floor.png</b> in your <b>assets</b> folder.</p>
    
    <button id="downloadBtn" style="display:none;">Download Floor</button>
    <br>
    <canvas id="canvas"></canvas>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        img.src = 'assets/floor.png'; // Make sure floor.png is in assets folder relative to this file

        // Settings for the output image
        // 3000x1200 should cover most monitor widths and the height of the leaf zone
        const WIDTH = 3000;
        const HEIGHT = 1200; 
        const TILE_SIZE = 600; 

        img.onload = () => {
            canvas.width = WIDTH;
            canvas.height = HEIGHT;

            // 1. Draw tiles with random rotation
            const cols = Math.ceil(WIDTH / TILE_SIZE) + 1;
            const rows = Math.ceil(HEIGHT / TILE_SIZE) + 1;

            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    ctx.save();
                    // Center of the tile
                    let cx = c * TILE_SIZE; 
                    let cy = r * TILE_SIZE;

                    // Random 90-degree rotation (0, 90, 180, 270)
                    const angle = Math.floor(Math.random() * 4) * (Math.PI / 2);
                    
                    ctx.translate(cx, cy);
                    ctx.rotate(angle);
                    ctx.drawImage(img, -TILE_SIZE/2, -TILE_SIZE/2, TILE_SIZE, TILE_SIZE);
                    ctx.restore();
                }
            }

            // 2. Darken the result
            ctx.fillStyle = 'rgba(0, 0, 0, 0.4)'; // 40% darkness overlay
            ctx.fillRect(0, 0, WIDTH, HEIGHT);

            // Enable download
            const btn = document.getElementById('downloadBtn');
            btn.style.display = 'inline-block';
            btn.onclick = () => {
                const link = document.createElement('a');
                link.download = 'complete_floor.png';
                link.href = canvas.toDataURL();
                link.click();
            };
        };
    </script>
</body>
</html>
